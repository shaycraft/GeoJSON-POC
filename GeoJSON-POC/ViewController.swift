//
//  ViewController.swift
//  GeoJSON-POC
//
//  Created by Samuel Haycraft on 3/17/23.
//

import UIKit

w
import ArcGIS

let sampleJsonResponse = """
{
    "exceededTransferLimit": true,
    "features": [
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "6 Cement Plant Lateral "
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.06713115000002,
                            40.66834425100001
                        ],
                        [
                            -105.06713886799997,
                            40.66835212900003
                        ],
                        [
                            -105.06714725900002,
                            40.668360586999995
                        ],
                        [
                            -105.06716122300003,
                            40.668357344000015
                        ],
                        [
                            -105.06717461699998,
                            40.66835432200003
                        ],
                        [
                            -105.06724070899998,
                            40.668338914
                        ],
                        [
                            -105.06727148200002,
                            40.66833123800001
                        ],
                        [
                            -105.06732861799998,
                            40.66831701000001
                        ],
                        [
                            -105.067405603,
                            40.668297773000006
                        ],
                        [
                            -105.06747876200001,
                            40.66827952699998
                        ],
                        [
                            -105.06760207899998,
                            40.66824871799997
                        ],
                        [
                            -105.06768417500001,
                            40.66822821699998
                        ],
                        [
                            -105.06786172800003,
                            40.66816706399999
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "Laporte Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.13178733400002,
                            40.654532243000006
                        ],
                        [
                            -105.132854028,
                            40.65454720499997
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "Laporte Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.13178915600002,
                            40.65568543500001
                        ],
                        [
                            -105.13178905000001,
                            40.65564552699999
                        ],
                        [
                            -105.13178867300002,
                            40.655394134000005
                        ],
                        [
                            -105.13178733400002,
                            40.654532243000006
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "8 Poudre River Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.04020286500003,
                            40.596137478
                        ],
                        [
                            -105.04027586400002,
                            40.596136383999976
                        ],
                        [
                            -105.04034898200001,
                            40.596135283000024
                        ],
                        [
                            -105.04042186200002,
                            40.596134198000016
                        ],
                        [
                            -105.04049498,
                            40.596133097000006
                        ],
                        [
                            -105.04056786000001,
                            40.596132012
                        ],
                        [
                            -105.040640871,
                            40.596131007
                        ],
                        [
                            -105.040713858,
                            40.59612982499999
                        ],
                        [
                            -105.04078686899999,
                            40.59612882099998
                        ],
                        [
                            -105.040859856,
                            40.596127638999974
                        ],
                        [
                            -105.04093286699998,
                            40.59612663399997
                        ],
                        [
                            -105.04100586599998,
                            40.59612554099999
                        ],
                        [
                            -105.04107885299999,
                            40.596124358
                        ],
                        [
                            -105.04115174499998,
                            40.596123362000014
                        ],
                        [
                            -105.04122461399999,
                            40.59612218799998
                        ],
                        [
                            -105.04129750599998,
                            40.596121192
                        ],
                        [
                            -105.04137038599998,
                            40.596120106
                        ],
                        [
                            -105.04144326599999,
                            40.59611902099999
                        ],
                        [
                            -105.04151602799999,
                            40.596117944000014
                        ],
                        [
                            -105.04159114499998,
                            40.596115623
                        ],
                        [
                            -105.04166391799998,
                            40.59611463499999
                        ],
                        [
                            -105.041736894,
                            40.59611336299997
                        ],
                        [
                            -105.04180757799998,
                            40.59611288299999
                        ],
                        [
                            -105.04188049700002,
                            40.596111167000004
                        ],
                        [
                            -105.041953321,
                            40.596109636999984
                        ],
                        [
                            -105.04197254399998,
                            40.596109248999994
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "8 Poudre River Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.03898905300002,
                            40.59615698099998
                        ],
                        [
                            -105.03899096200001,
                            40.59615693400002
                        ],
                        [
                            -105.03901944900002,
                            40.596155974
                        ],
                        [
                            -105.03910047400001,
                            40.59615305199998
                        ],
                        [
                            -105.03917710500002,
                            40.596151341999985
                        ],
                        [
                            -105.03924964100003,
                            40.59615037200001
                        ],
                        [
                            -105.03932230700002,
                            40.59614948299998
                        ],
                        [
                            -105.039394877,
                            40.596148778999975
                        ],
                        [
                            -105.03946758799998,
                            40.596148245999984
                        ],
                        [
                            -105.03954037199998,
                            40.59614734799999
                        ],
                        [
                            -105.03961349000002,
                            40.59614624699998
                        ],
                        [
                            -105.03968648900002,
                            40.596145154
                        ],
                        [
                            -105.03975936900002,
                            40.59614406999998
                        ],
                        [
                            -105.03983248700001,
                            40.59614296799998
                        ],
                        [
                            -105.039905368,
                            40.59614188400002
                        ],
                        [
                            -105.039978485,
                            40.59614078300001
                        ],
                        [
                            -105.040051366,
                            40.596139698
                        ],
                        [
                            -105.040124365,
                            40.59613860500002
                        ],
                        [
                            -105.040197364,
                            40.596137511999984
                        ],
                        [
                            -105.04020286500003,
                            40.596137478
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "8 Poudre River Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.057673244,
                            40.595946172000026
                        ],
                        [
                            -105.05774504499999,
                            40.59594506500002
                        ],
                        [
                            -105.05781671599999,
                            40.595943878000014
                        ],
                        [
                            -105.05788852799998,
                            40.59594285899999
                        ],
                        [
                            -105.05796031800003,
                            40.59594166300002
                        ],
                        [
                            -105.05803218099999,
                            40.595940102999975
                        ],
                        [
                            -105.058105619,
                            40.59593869999998
                        ],
                        [
                            -105.05817801400002,
                            40.595937549999974
                        ],
                        [
                            -105.05825042999999,
                            40.59593657800002
                        ],
                        [
                            -105.05832286999998,
                            40.595935783000016
                        ],
                        [
                            -105.05839496499999,
                            40.59593510299999
                        ],
                        [
                            -105.05846666999997,
                            40.59593418200001
                        ],
                        [
                            -105.05854024500002,
                            40.59593384499999
                        ],
                        [
                            -105.05861120999998,
                            40.595933693999996
                        ],
                        [
                            -105.05868435000002,
                            40.59593275899999
                        ],
                        [
                            -105.05875712300002,
                            40.59593176200002
                        ],
                        [
                            -105.05882974299999,
                            40.595930506
                        ],
                        [
                            -105.05890201800003,
                            40.59592936400003
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "8 Poudre River Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.07091155199998,
                            40.59576076000002
                        ],
                        [
                            -105.07093370500002,
                            40.59575800499999
                        ],
                        [
                            -105.07101220499999,
                            40.59574842699999
                        ],
                        [
                            -105.07109058600003,
                            40.595738858999994
                        ],
                        [
                            -105.071168838,
                            40.59572920900001
                        ],
                        [
                            -105.07124721899999,
                            40.59571964000003
                        ],
                        [
                            -105.07132544299998,
                            40.59571071099998
                        ],
                        [
                            -105.07139626399999,
                            40.59569818599999
                        ],
                        [
                            -105.07146495,
                            40.595685815000024
                        ],
                        [
                            -105.07152595000002,
                            40.59567605699999
                        ],
                        [
                            -105.071557988,
                            40.59566541800001
                        ],
                        [
                            -105.07158432900002,
                            40.59565796800001
                        ],
                        [
                            -105.07162778200001,
                            40.59564579200003
                        ],
                        [
                            -105.07168048699998,
                            40.59563106899998
                        ],
                        [
                            -105.071733015,
                            40.59561591099998
                        ],
                        [
                            -105.07178554400002,
                            40.595600751999996
                        ],
                        [
                            -105.07183807299998,
                            40.59558559300001
                        ],
                        [
                            -105.071890601,
                            40.595570434000024
                        ],
                        [
                            -105.07192367699997,
                            40.595556671
                        ],
                        [
                            -105.07195971599998,
                            40.595540812000024
                        ],
                        [
                            -105.07203259300002,
                            40.595510649999994
                        ],
                        [
                            -105.07210402800001,
                            40.59547951600001
                        ],
                        [
                            -105.072176963,
                            40.59544513499998
                        ],
                        [
                            -105.072249387,
                            40.595413302
                        ],
                        [
                            -105.072297069,
                            40.59539113599999
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "8 Poudre River Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -105.05613192800001,
                            40.59596302
                        ],
                        [
                            -105.05620422599998,
                            40.59596205700001
                        ],
                        [
                            -105.05627664299999,
                            40.59596108599999
                        ],
                        [
                            -105.05634895200001,
                            40.59596021300001
                        ],
                        [
                            -105.05642136900002,
                            40.59595924199999
                        ],
                        [
                            -105.05649532299998,
                            40.595959057000016
                        ],
                        [
                            -105.056568389,
                            40.59595848800001
                        ],
                        [
                            -105.05664155199997,
                            40.59595773299998
                        ],
                        [
                            -105.056714064,
                            40.595956575
                        ],
                        [
                            -105.05678691000003,
                            40.595955215000004
                        ],
                        [
                            -105.05686009599998,
                            40.59595463699998
                        ],
                        [
                            -105.056933162,
                            40.59595406699998
                        ],
                        [
                            -105.05700610999997,
                            40.59595350699999
                        ],
                        [
                            -105.05707912000003,
                            40.59595249300003
                        ],
                        [
                            -105.05715229399999,
                            40.595951825999975
                        ],
                        [
                            -105.05718109700001,
                            40.59595146700002
                        ],
                        [
                            -105.05725415199998,
                            40.595950808
                        ],
                        [
                            -105.05732619700001,
                            40.595950671000026
                        ],
                        [
                            -105.05739790199999,
                            40.59594974999999
                        ],
                        [
                            -105.05746960699997,
                            40.59594883
                        ],
                        [
                            -105.057541442,
                            40.595947989000024
                        ],
                        [
                            -105.05761314699998,
                            40.595947068999976
                        ],
                        [
                            -105.057673244,
                            40.595946172000026
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "Ault Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -104.773766938,
                            40.58208684599998
                        ],
                        [
                            -104.77374598,
                            40.582086687000015
                        ],
                        [
                            -104.77374238800002,
                            40.582086667
                        ]
                    ]
                ]
            }
        },
        {
            "attributes": {
                "LINE_LOOP_FULL_NAME": "4 Eaton Lateral"
            },
            "geometry": {
                "paths": [
                    [
                        [
                            -104.75675171900002,
                            40.531070043
                        ],
                        [
                            -104.75675332200001,
                            40.53105782799997
                        ],
                        [
                            -104.75675856999999,
                            40.531018913000025
                        ],
                        [
                            -104.75678683500001,
                            40.53080877299999
                        ],
                        [
                            -104.75679593799998,
                            40.53074099000003
                        ]
                    ]
                ]
            }
        }
    ],
    "fields": [
        {
            "alias": "Line Loop Full Name",
            "length": 64,
            "name": "LINE_LOOP_FULL_NAME",
            "type": "esriFieldTypeString"
        }
    ],
    "geometryType": "esriGeometryPolyline",
    "globalIdFieldName": "GLOBALID",
    "objectIdFieldName": "OBJECTID",
    "spatialReference": {
        "latestWkid": 4326,
        "wkid": 4326
    }
}
""";

class ViewController: UIViewController {
    @IBOutlet weak var mapView: AGSMapView!
    
    private func setupMap() {
        let map = AGSMap(
            basemapStyle: .arcGISTopographic
        )
        
        mapView.map = map
        //
        //        mapView.setViewpoint(
        //            AGSViewpoint(
        //                latitude: 34.02700,
        //                longitude: -118.80500,
        //                scale: 72_000
        //            )
        //        )
    }
    
    func parseExampleFromStackOverflow() {
        do {
            let data =  "{\"names\": [\"Bob\", \"Tim\", \"Tina\"]}"
            if let json = try JSONSerialization.jsonObject(with: Data(sampleJsonResponse.utf8)) as? [String: Any] {
                // print("Json is \(json)")
                print("Json is good")
                let arcGisplygon = try AGSPolyline.fromJSON(json)
            }
        }
        catch {
            print("Failed to load: \(error.localizedDescription)")
            print("Raw error is \(error)")
        }
    }
    
    override func viewDidLoad() {
        super.viewDidLoad()
        
        // self.parseExampleFromStackOverflow()
        setupMap()
        
        // Do any additional setup after loading the view.
        
        //        //        let someString = "{'foo': 'bar'}"
        //        do {
        //            let myJsonObject = try JSONSerialization.jsonObject(with: sampleJsonResponse.data(using: .utf8)!) as? [String: Any]
        //            print (myJsonObject["spatialReference"])
        //        }
        //        catch {
        //            print("ERRORRRR!!!!")
        //            print("[DEBUG=====]: \(error)")
        //        }
        
        //        let str = "{\"names\": [\"Bob\", \"Tim\", \"Tina\"]}"
        //        let data = Data(sampleJsonResponse.utf8)
        //
        //        do {
        //            // make sure this JSON is in the format we expect
        //            if let json = try JSONSerialization.jsonObject(with: data) as? [String: Any] {
        //                // try to read out a string array
        //                print(json["spatialReference"]!)
        //                if let names = json["names"] as? [String] {
        //                    print(names)
        //                }
        //            }
        //        } catch let error as NSError {
        //            print("Failed to load: \(error.localizedDescription)")
        //        }
    }
    
    
    
}

